<!DOCTYPE html>
<html>
<head>
  <title>Hello jQuery</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script>
  function getParameterByName(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
  }
 
  var connectUrl = getParameterByName('connectUrl'); // https://r.connect.sncf.com/SvcECZ/json/sncfconnect
  var redirectUrl = getParameterByName('redirectUrl');
  var host = getParameterByName('host');
 
  console.log(connectUrl);
  console.log(redirectUrl);
 
  $(document).ready(function() {
    $.ajax({
      url: connectUrl + '/authenticate?authIndexType=service&authIndexValue=ldapServicePersistent',
      type: 'POST',
      crossDomain: true,
      headers: {
            'Access-Control-Allow-Origin': host
      }
    }).then(function(data) {
      console.log(data);
      if (data.tokenId) {
        $.ajax({
          url : connectUrl + '/sessions/?_action=logout',
          type : 'POST',
          headers: {
            'Cookie': 'iPlanetDirectoryPro=' + data.tokenId,
            'Access-Control-Allow-Origin': host
          },
          crossDomain: true
        }).then(function(data, status) {
          if (status == "200") {
            window.location.href = redirectUrl + '?status=success';
          } else {
            window.location.href = redirectUrl + '?status=failure';
          }
        });
      } else {
        window.location.href = redirectUrl + '?status=success';
      }
    });
  });
  </script>
</head>
<body>
  <div>
    <p>...</p>
  </div>
</body>
</html>